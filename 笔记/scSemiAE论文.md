
####  模型结构：三阶段训练流程

##### （1）Annotation 标签注释阶段

- 使用现有分类器（如 SciBet、Garnett）为目标数据进行标签预测
- 只保留置信度高的预测作为“伪标签”

##### （2）Pretraining 预训练阶段

- 使用所有细胞训练一个**Autoencoder**，学习初始低维表示
- 损失函数是MSE


##### （3）Fine-tuning 微调阶段

- 用**带标签的细胞**进一步调整编码器，使其满足：
    - 同类细胞距离更近（L1损失）
    - 异类细胞中心距离更远（L2损失）
        
- 总损失为：
	-  $L = L_1 - \lambda L_2$
    - λ = 1（默认）
        

---

### 网络结构和训练细节

- 编码器结构：5000 → 500 → 50 维度
- 激活函数：ELU
- 优化器：Adam
- 微调阶段学习率减半，每5个epoch调整一次
- 训练周期：预训练50轮 + 微调60轮

---

