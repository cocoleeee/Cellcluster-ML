

>**scSemiAE: a deep model with semi-supervised learning for single-cell transcriptomics**  


---
    
- **关键想法**：充分利用“可获得的带标签单细胞数据”的**先验信息**，把这部分信息**转移**到目标数据的潜在空间学习中。与纯无监督相比，可在低标签比例下提升表现；与纯监督注释不同，不妨碍发现新亚群。
    

---

## 方法框架

1. **Annotation（外部注释）**：用现成的细胞类型预测器（如 SciBet/ScMap/Garnett/CellAssign 等）对目标数据打标签，**只保留高置信度**的预测作为“部分标签”。
    
2. **Pretraining（无监督预训练）**：对**全部细胞**训练一个 AE，以重构损失（MSE）学习通用表示。此阶段得到的**编码器权重**作为后续初始化。
    
3. **Fine-tuning（半监督微调）**：仅用**部分带标签**细胞，优化一个**聚簇友好**的目标：
    
    - 让**同类更紧**（类内均方距离 L1 小）
        
    - 让**异类更远**（类别中心两两最小距离 L2 大）
        
    - **最终目标**：最小化 Lm=L1−λL2（文中记作正则系数 λ\lambda，默认 1），仅更新**编码器**以得到判别性潜在空间。
        

---

## 数据预处理

- 过滤全零基因/细胞；Scanpy 规范化，使每个细胞的总计数对齐到**原始总计数中位数**；选取**方差最高的 5000 基因**参与训练。
    

---

##  模型

- **结构**：编码器两层全连接 **5000 → 500 → 50**；解码器镜像对称。隐藏层用**LayerNorm**，激活为 **ELU**。
    
- **优化**：Adam，预训练 50 epoch（重构损失），微调 60 epoch；微调阶段每 5 个 epoch 将学习率**减半**。微调仅更新**编码器**。默认 λ=1。
    

---


## 复现
任选现成注释器，把不确定的样本标为 unknown，仅保留高置信度子集做微调监督。
    
- **流程**：
    
    1. 预处理（筛零、规范化、log1p、Top-HVG=5000）。      
    2. 预训练 AE（MSE，50 epoch）。    
    3. 拿编码器做初始化，用半监督目标 L1−λL2L_1-\lambda L_2 微调 60 epoch（λ=1\lambda=1，每 5 epoch 降半 LR）。    
    4. 在潜在空间上做 kNN/Louvain/K-means、可视化 UMAP。
        

    
